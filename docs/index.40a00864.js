/*! signal-v-noise v2022.11.02 | (c) 2024 benjmnrsh | ISC License | https://github.com/bnjmnrsh-projs/signal-v-noise */

!function(){const e=["home","arts","automobiles","books","business","climate","dining","fashion","food","health","insider","magazine","movies","nyregion","obituaries","opinion","politics","realestate","science","sports","style","sundayreview","technology","theater","t-magazine","travel","upshot","us","world"];function t(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function n(e,t){return t.get?t.get.call(e):t.value}function o(e,o){return n(e,t(e,o,"get"))}function r(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s(e,t,n){r(e,t),t.set(e,n)}function i(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function a(e,n,o){return i(e,t(e,n,"set"),o),o}function l(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function c(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}function u(e,t,n){return c(e,t),n}var d,h,w,f=new WeakMap,m=new WeakMap,p=new WeakMap,g=new WeakSet;
/* ! @preserve @bnjmnrsh/satchel v0.2.4.1 | (c) 2022 bnjmnrsh | ISC | https://github.com/bnjmnrsh/satchel */class y{static set stcl(e){if("string"!=typeof e)throw new Error("Satchel.stcl must be a string.");this._stcl=e}static get stcl(){return this._stcl?this._stcl:"stcl"}age(){const e=JSON.parse(o(this,m).getItem(o(this,f)));return e?{age:Date.now()-e._creation,creation:e._creation,expiry:e.expiry?e.expiry:null,fresh:this.isFresh()}:null}bin(){const e=o(this,m).getItem(o(this,f));return e?(o(this,m).removeItem(o(this,f)),u(y,y,b).call(y,{key:o(this,f),oldValue:e,storageArea:u(y,y,v).call(y,o(this,m)),action:"bin"}),!0):null}get(e=!1){const t=o(this,m).getItem(o(this,f));return t?!!(this.isFresh()&&!e||e)&&JSON.parse(t):null}set({data:e,expiry:t}){const n=JSON.parse(o(this,m).getItem(o(this,f)));if(e=n?.data&&!e?n.data:e,t=n?.expiry&&!t?n.expiry:t,e&&"string"!=typeof e&&"number"!=typeof e&&!l(this,g,S).call(this,e))throw new Error("Satchel.set({data}): must be either null or a number, string or object.");if("number"!=typeof t&&null!==t)throw new Error('Satchel.set({expiry}): "expiry" must be null or a number.');if(e&&l(this,g,S).call(this,e))try{JSON.parse(JSON.stringify(e))}catch(e){throw new Error(`Satchel.set({data}): ${e}`)}const r=this.get(!0),s={};return s.data=e||null,s.expiry=t||null,s._creation=r?._creation||Date.now(),o(this,m).setItem(o(this,f),JSON.stringify(s)),u(y,y,b).call(y,{key:o(this,f),newValue:JSON.stringify(s),oldValue:r?JSON.stringify(r):null,storageArea:u(y,y,v).call(y,o(this,m)),action:"set"}),this}isFresh(){const e=JSON.parse(o(this,m).getItem(o(this,f)));return e?!e?.expiry||e.expiry-Date.now()>0:null}getKey(){return o(this,f)}static getSatchel(e,t=!1,n="pocket"){if(!e)throw new Error('Satchel.getSatchel(key): a "key" is required.');if("string"!=typeof e)throw new Error('Satchel.getSatchel(key): "key" must be a string.');if("boolean"!=typeof t)throw new Error('Satchel.getSatchel(key, local): "local" must be a boolean.');if("string"!=typeof n)throw new Error('Satchel.getSatchel(key, local, pocket): "pocket" must be an string.');const o=`${y.stcl}.${n}.${e}`,r=t?window.localStorage:window.sessionStorage,s=JSON.parse(r.getItem(o));return s&&0!==s.length?new y(e,s,t,n):null}static setKey(e=null,t={},n=!1,o="pocket"){new y(e,t,n,o)}constructor(e=null,t={},n=!1,i="pocket"){var c,u;if(r(c=this,u=g),u.add(c),s(this,f,{writable:!0,value:void 0}),s(this,m,{writable:!0,value:void 0}),s(this,p,{writable:!0,value:void 0}),a(this,m,n?window.localStorage:window.sessionStorage),!e)throw new Error('Satchel: a "key" is required.');if("string"!=typeof e)throw new Error('Satchel: "key" must be a string.');if(!l(this,g,S).call(this,t))throw new Error("Satchel: {cargo} must be an object.");if("boolean"!=typeof n)throw new Error('Satchel: "local" must be a boolean.');if("string"!=typeof i)throw new Error('Satchel: "pocket" must be a string.');a(this,f,`${y.stcl}.${i}.${e}`),a(this,p,{data:void 0,expiry:null}),t={...o(this,p),...t},this.set(t)}}function b(e={}){e={key:null,newValue:null,oldValue:null,storageArea:null,url:window.location.href,action:null,...e};const t=new CustomEvent("Satchel",{bubbles:!0,cancelable:!0,detail:e});return document.dispatchEvent(t)}function v(e){return e===window.localStorage?"LocalStorage":"SessionStorage"}function S(e){return e&&"object"==typeof e&&e.constructor===Object}w=void 0,(h="_stcl")in(d=y)?Object.defineProperty(d,h,{value:w,enumerable:!0,configurable:!0,writable:!0}):d[h]=w;function $(e,t=!1){const n=y.getSatchel(e,!0,"svn-store");if(!n)return console.warn(`storedArticles no results for "${e}"`),!1;if(console.log("storedArticles section:",n?.getKey()),console.log("storedArticles isFresh:",n?.isFresh()),n?.isFresh()||!navigator.onLine||t){const o=n?.get(!navigator.onLine||t)?.data;return o||(console.log(`${e} not in sessionStorage ...`),!1)}}async function E(e="home"){return document.body.classList.add("loading"),new Promise(((t,n)=>{if(document.querySelector("#articles")){const o=$(e);if(o)return t(o);(async function(e){return console.log("fetching fresh articles..."),fetch("https://signal-v-noise-worker.bnjmnrsh.workers.dev?section="+e).then((function(e){const t=e.json();if(e.ok&&200===e.status)return t;throw e})).then((function(t){if("OK"!==t.top_stories.status)throw t;const n=Date.now()+3e5;return y.setKey(e,{data:t,expiry:n},!0,"svn-store"),t})).catch((function(t){if(console.warn(t),200!==t?.top_stories?.status){console.warn(`${t?.top_stories?.status} status code, attempting to load stale ${e} from store...`);const n=$(e,!0);if(n)return n}throw t}))})(e).then((e=>t(e))).catch((o=>{console.warn(o);const r=$(e,!0);return r?t(r):n(o)}))}}))}const k=function(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML};const L=function(e={},t=".observable",n="loaded"){e={...{root:document.querySelector("body"),rootMargin:"0px",threshold:1},...e};const o=document.querySelectorAll(t);if(!o.length)return void console.warn("No observerable elements named",t);const r=new IntersectionObserver((function(e){e.forEach((e=>{e.isIntersecting&&e.target.classList.add(n)}))}),e);o.forEach((e=>r.observe(e)))},A=function(t){document.querySelector("#articles").innerHTML=t.top_stories.results.map((function(t){const n=e.indexOf(k(t.section))>=0;if(!n&&("admin"===t.section||"espanol"===t.section))return"";if(!t.abstract)return"";let o=`<li>\n                                    <article class="news-item ${k(t.section)}">\n                                        <header>`;return"multimedia"in t&&null!==t.multimedia&&t.multimedia.length>=3&&(o+=`<a href="${k(t?.url)}" title="${k(t.title)}">\n                          <img class="loading-bg"\n                                scrset="\n    ${k(t.multimedia[0]?.url)} ${k(t?.multimedia[0]?.width)}w,\n    ${k(t.multimedia[1]?.url)} ${k(t?.multimedia[1]?.width)}w,\n    ${k(t.multimedia[2]?.url)} ${k(t?.multimedia[2]?.width)}w"\n\n                            src="${k(t.multimedia[1]?.url)}"\n                            height="${k(t.multimedia[1]?.height)}"\n                            width="${k(t?.multimedia[1]?.width)}"\n                            alt="${k(t?.multimedia[1]?.copyright)}"\n                            loading="lazy" role="presentation"/></a>`),o+=`</header>\n                                        <section class="news-content">\n                                            <header>\n                                                <h3 class="hyphens"><a href="${k(t.url)}">${t.title}</a></h3>\n                                                  <p class="details">`,n?o+=`<a class="pill ${k(t.section)}" href="https://www.nytimes.com/section/${k(t.section)}">`:t.section&&(o+=`<span class="pill ${k(t.section)}">`),o+=`${k(t.section)} ${n?"</a>":"</span>"}\n                                                    ${t?.byline?'<span class="byline">':""}\n                                                    ${t?.byline?k(t?.byline):""}\n                                                    ${t?.byline?"</span>":""}\n                                                </p>\n                                            </header>\n                                            <div class="abstract">`,t.abstract&&(o+=`<p class="hyphens">${k(t?.abstract)}\n                                        <a href="${k(t.url)}" title="${k(t.title)}" class="read-more">[...more]</a>\n                                      </p>`),o+="</div>\n                                        </section>\n                                    </article>\n                                </li>",o})).join(""),L({root:document.querySelector("#newsfeed-wrap"),threshold:.25},".news-item")},q=function(){const e=window.location.hash.replace("#","");document.querySelector("nav.noise").querySelectorAll(".pill").forEach((function(t){t.classList.contains(e)?(console.log(`navActiveLink: setting active link: ${e}`),t.classList.add("active")):t.classList.remove("active")}))};function T(e){const t=document.querySelector("#articles");console.warn(e);const n=`\n<div id="ohnos">\n  <h3><span aria-hidden="true">⥀.⥀ <br/></span>Oh Nooos!</h3>\n  <p class="sr-only">There has been a critical error:</p>\n    <div>\n<pre>\n${e.stack||""}\n${e.type||""}\n${e.statusText||""} ${e.status||""}\n${429===e.top_stories?.status?`${e.top_stories.status} too many requests`:e.top_stories?.status}\n${e.top_stories?.error||""}\n${e.top_stories?.error_message?` Route not found: ${e.top_stories.error_message.split("/").pop().replace(".json","")}`:""}\n</pre>\n    </div>\n</div>`;t.innerHTML=n}const _=async function(){let e=window.location.hash.replace("#",""),t=document.querySelector("#app").getAttribute("data-section");e=e||"home",!t&&e&&(t=e,e&&document.querySelector("#app").setAttribute("data-section",e)),"null"===e||"head"===e?(window.removeEventListener("hashchange",_),window.location.hash=t,setTimeout((()=>window.addEventListener("hashchange",_)),1)):e&&(document.body.querySelector("#newsfeed-wrap").scrollTo(0,0),q(),E(e).then((function(e){return A(e)})).then(setTimeout((()=>document.body.classList.remove("loading")),300)).catch((e=>{throw T(e),new Error("Unable to build articles",{cause:e})})))};function x(e=!1,t="pocket",n="stcl"){const o=e?window.localStorage:window.sessionStorage,r=Object.keys(o).map((e=>e.startsWith(n+"."+t)?e:"")).filter((e=>e));return Array.from(r)}window.addEventListener("hashchange",_);window.addEventListener("Satchel",(function(e){if("Satchel"!==e.type)return;if("svn-store"!==e.detail.key.split(".")[1])return;const t=e.detail.key.split(".")[2];document.querySelectorAll(`[data-section="${t}"]`).forEach((e=>{e.setAttribute("data-stored",!0)}))}
/* ! @preserve @bnjmnrsh/toast v0.1.0 | (c) 2022 bnjmnrsh | ISC | git+https://github.com/bnjmnrsh/Toast.git */));const N=function(e={}){const t={selector:"body",className:"toast"};return function(e){let n=0;const o={};if(o.settings={...t,...e},o.className=o.settings.className,o.target=document.querySelector(o.settings.selector),!o.target)throw new Error(`Toast: the target element "${o.settings.selector}" could not be found.`);return o.create=function(e,t=0,r=!1,s=!0,i=[],a=!1){if(!e)throw new Error("Toast.js requires a message string!");a=a||`${o.settings.selector}-${n++}`.toString();const l=document.createElement("div");return l.setAttribute("role","alert"),l.setAttribute("data-toast-id",a),l.classList.add(this.className,...i),t&&setTimeout((()=>l.remove()),t),r?(l.innerHTML=`${e} <button class="toast-close" arial-lable="close">&#x2715</button>`,l.addEventListener("click",(function(e){e.target.matches(".toast-close")&&(l.remove(),l.removeEventListener("click",close))}))):l.innerHTML=`${e}`,s?o.target.prepend(l):o.target.append(l),setTimeout((()=>l.innerHTML),1),a},o.destroy=function(e){if(!e)return!1;const t=document.querySelector(`[data-toast-id="${e}"]`);return!!t&&(t.remove(),o)},o}}(),O=function(e,t=!0){e&&e.forEach((function(e){t?"false"===e.dataset.stored&&(e.setAttribute("data-hash",e.href?.split("#")[1]),e.removeAttribute("href"),e.setAttribute("aria-disabled",!0)):"false"===e.dataset.stored&&(console.log("disableEnableLinks",e.dataset),e.setAttribute("href","#"+e.dataset.hash),e.removeAttribute("aria-disabled"),e.removeAttribute("data-hash"))}))},j=document.querySelector("#app");!function(){const e=navigator.onLine?"online":"offline";document.body.setAttribute("data-network",e);const t=new N;let n="",o=Date.now().toString();window.addEventListener("offline",(e=>{const r=document.querySelectorAll(".noise .pill");console.warn("Network unavailable",r),o=Date.now(),O(r),document.body.setAttribute("data-network","offline"),n=t.create("Sorry, you are currently off line",0,!1,!0,["offline-notice"])})),window.addEventListener("online",(()=>{const e=document.querySelectorAll(".noise .pill");console.warn("Network available",e),document.body.setAttribute("data-network","online"),O(e,!1),Date.now()-o>3e4&&_(),t.destroy(n)}))}(),function(e,t){const n=x(!0,"svn-store");e.querySelector("nav").innerHTML="<ul>"+t.map((function(e){return`<li><a href="#${e}" class="pill ${e}" data-section="${e}" data-stored="${n.includes("stcl.svn-store."+e)}">${e}</a></li>`})).join("")+"</ul>"}(j,e),_(),function(e,t=125){const n=document.querySelector(e),o=document.querySelector("#stt"),r=function(e){(e.scrollY||e.scrollTop)>t?(document.body.classList.add("scrolled"),o.classList.add("-is-revealed")):(document.body.classList.remove("scrolled"),o.classList.remove("-is-revealed"))};window.addEventListener("scroll",(e=>r(window))),n.addEventListener("scroll",(e=>r(n))),o.addEventListener("click",(e=>{document.scrollingElement.scrollTo(0,0),n.scrollTo(0,0)}))}("#newsfeed-wrap")}();
//# sourceMappingURL=index.40a00864.js.map
